{% load credit_tags %}
{% load dining_tags %}
{% load humanize %}

<tr>
    <td>
        {{ transaction.order_moment|naturaltime }}
    </td>
    <td>
        {% if transaction.source_user == user %}
            To
        {% else %}
            From
        {% endif %}
    </td>
    <td>
        {% if transaction.source == user %}
            {{ transaction.target }}
        {% else %}
            {{ transaction.source }}
        {% endif %}
    </td>
    <td>
        {% if transaction.source_user == user %}
            <span class="text-danger">{{ transaction.amount|negate|euro }}</span>
        {% else %}
            <span class="text-success">+{{ transaction.amount|euro }}</span>
        {% endif %}
    </td>
    <td>
        {{ transaction.description }}
    </td>
    <td class="py-2">
        {% if transaction.type == 2 %}
        <a class="btn btn-outline-primary"
           href="{% url 'credits:transaction_add' %}?redirect={{ request.path }}">
            <i class="fas fa-pen"></i>
        </a>
        {% elif transaction.type == 3 %}
            {% with transaction.id|get_dining_slot as slot %}
                <a class="btn btn-outline-primary"
                   href="{{ slot.get_absolute_url }}">
                    <i class="fas fa-search"></i>
                </a>
            {% endwith %}
        {% endif %}

    </td>
</tr>